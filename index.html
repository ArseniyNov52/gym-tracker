<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GymFlow - –¢—Ä–µ–∫–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</title>
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RH1WWR3XTP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RH1WWR3XTP');
  </script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e3f2fd 50%, #f5f7fa 100%);
      min-height: 100vh;
    }
    
    .header {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid #e2e8f0;
      position: sticky;
      top: 0;
      z-index: 50;
    }
    
    .header-content {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0.75rem 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-height: 56px; /* <CHANGE> –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ min-height –≤–º–µ—Å—Ç–æ height */
      flex-wrap: wrap; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω flex-wrap –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ */
      gap: 0.5rem; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω gap */
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
    }
    
    .logo-icon {
      width: 36px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      height: 36px;
      background: linear-gradient(135deg, #2563eb 0%, #4f46e5 100%);
      border-radius: 10px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .logo-text h1 {
      font-size: 1.125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 700;
      color: #0f172a;
    }
    
    .logo-text p {
      font-size: 0.7rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      color: #64748b;
      display: none; /* <CHANGE> —Å–∫—Ä—ã—Ç –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
    }

    /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ > 480px */
    @media (min-width: 480px) {
      .logo-text p {
        display: block;
      }
    }
    
    .timer-display {
      display: flex;
      align-items: center;
      gap: 0.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
      background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      padding: 0.375rem 0.75rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      border-radius: 10px;
      border: 1px solid #6ee7b7;
    }
    
    .timer-icon {
      font-size: 14px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .timer-text {
      font-family: 'Courier New', monospace;
      font-size: 0.95rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 600;
      color: #047857;
    }
    
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
    }
    
    .nav {
      margin-bottom: 1.5rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
    }
    
    .nav-buttons {
      background: white;
      border-radius: 12px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      padding: 0.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
      display: flex;
      gap: 0.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
      overflow-x: auto;
      -webkit-overflow-scrolling: touch; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω smooth scroll –¥–ª—è iOS */
    }
    
    .nav-btn {
      display: flex;
      align-items: center;
      gap: 0.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
      padding: 0.5rem 0.75rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      border-radius: 10px;
      font-size: 0.8125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      background: transparent;
      color: #64748b;
      flex-shrink: 0; /* <CHANGE> –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ */
    }
    
    .nav-btn:hover {
      background: #f8fafc;
      color: #0f172a;
    }
    
    .nav-btn.active {
      background: linear-gradient(135deg, #2563eb 0%, #4f46e5 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .card {
      background: white;
      border-radius: 12px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      padding: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
      margin-bottom: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
    }
    
    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
      gap: 0.75rem; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω gap */
      flex-wrap: wrap; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω flex-wrap */
    }
    
    .card-title {
      font-size: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 700;
      color: #0f172a;
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
      padding: 0.5rem 0.875rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      border-radius: 10px;
      font-size: 0.8125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      touch-action: manipulation; /* <CHANGE> —É–ª—É—á—à–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –∫–∞—Å–∞–Ω–∏—è */
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #2563eb 0%, #4f46e5 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .btn-primary:hover {
      box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
      transform: translateY(-1px);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%);
      color: white;
    }
    
    .btn-secondary {
      background: #f1f5f9;
      color: #475569;
    }
    
    .btn-danger {
      background: #fee2e2;
      color: #dc2626;
    }
    
    .btn-large {
      padding: 0.875rem 1.5rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      font-size: 0.9375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
      font-weight: 600;
    }
    
    .empty-state {
      text-align: center;
      padding: 2.5rem 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      color: #64748b;
    }
    
    .empty-icon {
      font-size: 3rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      margin-bottom: 0.75rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
      opacity: 0.5;
    }
    
    .empty-title {
      font-size: 1.125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 600;
      color: #0f172a;
      margin-bottom: 0.5rem;
    }
    
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0.75rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
    }
    
    .modal {
      background: white;
      border-radius: 12px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      max-width: 42rem;
      width: 100%;
      max-height: 90vh;
      overflow: hidden;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }
    
    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      border-bottom: 1px solid #e2e8f0;
    }
    
    .modal-title {
      font-size: 1.125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 700;
      color: #0f172a;
    }
    
    .modal-close {
      background: none;
      border: none;
      font-size: 1.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      cursor: pointer;
      color: #94a3b8;
      transition: color 0.2s;
      padding: 0.25rem; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω padding –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∑–æ–Ω—ã —Ç–∞–ø–∞ */
      min-width: 44px; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ç–∞–ø–∞ */
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal-close:hover {
      color: #475569;
    }
    
    .modal-body {
      padding: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      overflow-y: auto;
      max-height: calc(90vh - 88px);
      -webkit-overflow-scrolling: touch; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω smooth scroll –¥–ª—è iOS */
    }
    
    .input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }
    
    .input:focus {
      outline: none;
      border-color: #2563eb;
    }
    
    .label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: #475569;
      margin-bottom: 0.5rem;
    }
    
    .form-group {
      margin-bottom: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
    }
    
    .stat-card {
      background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
      border-radius: 10px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      padding: 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      border: 1px solid #e2e8f0;
    }
    
    .stat-icon {
      width: 42px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      height: 42px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      margin-bottom: 0.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .stat-value {
      font-size: 1.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 700;
      color: #0f172a;
      margin-bottom: 0.25rem;
    }
    
    .stat-label {
      font-size: 0.8125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      color: #64748b;
    }
    
    .grid {
      display: grid;
      gap: 0.875rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω minmax –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
    }
    
    .exercise-item {
      border: 1px solid #e2e8f0;
      border-radius: 10px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      padding: 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      transition: border-color 0.2s;
    }
    
    .exercise-item:hover {
      border-color: #93c5fd;
    }
    
    .set-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #f8fafc;
      border-radius: 8px;
      padding: 0.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      margin-bottom: 0.5rem;
      gap: 0.5rem; /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω gap –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–∞–ª–æ–∂–µ–Ω–∏–π */
    }
    
    .chart-container {
      background: #f8fafc;
      border-radius: 10px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      padding: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      margin-bottom: 1.25rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
    }
    
    .chart-title {
      font-size: 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 600;
      color: #0f172a;
      margin-bottom: 0.875rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
    }
    
    .achievement-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω minmax –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
      gap: 0.875rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
    }
    
    .achievement-card {
      border: 2px solid #e2e8f0;
      border-radius: 10px; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω border-radius */
      padding: 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      text-align: center;
      transition: all 0.2s;
    }
    
    .achievement-card.unlocked {
      border-color: #93c5fd;
      background: #eff6ff;
    }
    
    .achievement-card.locked {
      opacity: 0.6;
      filter: grayscale(100%);
    }
    
    .achievement-icon {
      font-size: 2.5rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      margin-bottom: 0.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω margin */
    }
    
    .achievement-title {
      font-weight: 700;
      font-size: 1rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      color: #0f172a;
      margin-bottom: 0.25rem;
    }
    
    .achievement-desc {
      font-size: 0.8125rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      color: #64748b;
    }
    
    .counter {
      display: flex;
      align-items: center;
      gap: 0.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
    }
    
    .counter-btn {
      width: 44px; /* <CHANGE> —É–≤–µ–ª–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ç–∞–ø–∞ */
      height: 44px;
      background: #f1f5f9;
      border: none;
      border-radius: 8px;
      font-size: 1.25rem;
      font-weight: 700;
      color: #475569;
      cursor: pointer;
      transition: background 0.2s;
      flex-shrink: 0; /* <CHANGE> –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ */
      touch-action: manipulation; /* <CHANGE> —É–ª—É—á—à–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –∫–∞—Å–∞–Ω–∏—è */
    }
    
    .counter-btn:hover {
      background: #e2e8f0;
    }
    
    .counter-input {
      flex: 1;
      text-align: center;
      font-size: 1.375rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      font-weight: 700;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 0.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      min-width: 0; /* <CHANGE> –ø–æ–∑–≤–æ–ª—è–µ—Ç input —Å–∂–∏–º–∞—Ç—å—Å—è */
    }
    
    .mood-selector {
      display: flex;
      gap: 0.625rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω gap */
    }
    
    .mood-btn {
      flex: 1;
      padding: 0.875rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω padding */
      font-size: 1.75rem; /* <CHANGE> —É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä */
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
      min-width: 0; /* <CHANGE> –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∞–º —Å–∂–∏–º–∞—Ç—å—Å—è */
      touch-action: manipulation; /* <CHANGE> —É–ª—É—á—à–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –∫–∞—Å–∞–Ω–∏—è */
    }
    
    .mood-btn.selected {
      border-color: #2563eb;
      background: #eff6ff;
      transform: scale(1.05);
    }

    /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ */
    @media (min-width: 640px) {
      .grid {
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      }
      
      .achievement-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }

      .card {
        padding: 1.5rem;
      }

      .card-title {
        font-size: 1.5rem;
      }

      .stat-value {
        font-size: 2rem;
      }

      .chart-container {
        padding: 1.5rem;
      }
    }

    /* <CHANGE> –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */
    @media (min-width: 1024px) {
      .container {
        padding: 2rem 1rem;
      }

      .nav {
        margin-bottom: 2rem;
      }

      .card {
        padding: 1.5rem;
        border-radius: 16px;
      }

      .nav-buttons {
        padding: 0.5rem;
        border-radius: 16px;
      }

      .achievement-icon {
        font-size: 3rem;
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        font-size: 24px;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    const exerciseDatabase = {
      '–ì—Ä—É–¥—å': ['–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª–µ–∂–∞','–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –Ω–∞–∫–ª–æ–Ω–Ω–æ–π —Å–∫–∞–º—å–µ','–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª–µ–∂–∞','–†–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ª–µ–∂–∞','–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞','–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ ¬´–ë–∞–±–æ—á–∫–∞¬ª','–ö—Ä–æ—Å—Å–æ–≤–µ—Ä—ã'],
      '–°–ø–∏–Ω–∞': ['–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è','–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞','–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ','–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ –∫ –≥—Ä—É–¥–∏','–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è','–®—Ä–∞–≥–∏ —Å–æ —à—Ç–∞–Ω–≥–æ–π'],
      '–ù–æ–≥–∏': ['–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π','–ñ–∏–º –Ω–æ–≥–∞–º–∏','–í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏','–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ','–°–≥–∏–±–∞–Ω–∏—è –Ω–æ–≥ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ','–ü–æ–¥—ä–µ–º—ã –Ω–∞ –Ω–æ—Å–∫–∏'],
      '–ü–ª–µ—á–∏': ['–ê—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º','–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è','–ú–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã','–ú–∞—Ö–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ','–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É'],
      '–ë–∏—Ü–µ–ø—Å': ['–ü–æ–¥—ä–µ–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å','–ü–æ–¥—ä–µ–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –±–∏—Ü–µ–ø—Å','–°–≥–∏–±–∞–Ω–∏—è ¬´–º–æ–ª–æ—Ç¬ª','–°–≥–∏–±–∞–Ω–∏—è –Ω–∞ —Å–∫–∞–º—å–µ –°–∫–æ—Ç—Ç–∞'],
      '–¢—Ä–∏—Ü–µ–ø—Å': ['–ñ–∏–º –ª–µ–∂–∞ —É–∑–∫–∏–º —Ö–≤–∞—Ç–æ–º','–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º','–†–∞–∑–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–ª–æ–∫–µ','–û—Ç–∂–∏–º–∞–Ω–∏—è –Ω–∞ –±—Ä—É—Å—å—è—Ö'],
      '–ü—Ä–µ—Å—Å': ['–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è','–ü–æ–¥—ä–µ–º –Ω–æ–≥ –≤ –≤–∏—Å–µ','–ú–æ–ª–∏—Ç–≤–∞ –Ω–∞ –±–ª–æ–∫–µ']
    };

    const ACHIEVEMENT_CATEGORIES = [
      {name: '–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ', achievements: [
        {id: 'c1', title: '–ù–æ–≤–∏—á–æ–∫', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 1 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: 'üå±'},
        {id: 'c10', title: '–ü—Ä–∏–≤—ã—á–∫–∞', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 10 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', icon: 'üí™'},
        {id: 'c50', title: '–†–∞–±–æ—Ç—è–≥–∞', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 50 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', icon: 'üî•'},
        {id: 'c100', title: '–í–µ—Ç–µ—Ä–∞–Ω –∑–∞–ª–∞', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 100 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', icon: 'üèÜ'},
        {id: 'c200', title: '–ñ–µ–ª–µ–∑–Ω–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 200 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', icon: '‚ö°'},
        {id: 'c400', title: '–ú–∞—Å—Ç–µ—Ä —Ç—Ä–µ–Ω–∞–∂—ë—Ä–Ω–æ–≥–æ –∑–∞–ª–∞', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 400 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', icon: 'üî±'},
        {id: 'c800', title: '–õ–µ–≥–µ–Ω–¥–∞ —Å–ø–æ—Ä—Ç–∞', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 800 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', icon: 'üëë'}
      ]},
      {name: '–í–µ—Å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö', achievements: [
        {id: 'v1t', title: '–ü–µ—Ä–≤–∞—è —Ç–æ–Ω–Ω–∞', description: '–ü–æ–¥–Ω—è—Ç—å >1 —Ç –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: 'üèãÔ∏è'},
        {id: 'v2t', title: '–î–≤–æ–π–Ω–∞—è —Å–∏–ª–∞', description: '–ü–æ–¥–Ω—è—Ç—å >2 —Ç –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: 'üí™'},
        {id: 'v5t', title: '–°–∏–ª–∞—á', description: '–ü–æ–¥–Ω—è—Ç—å >5 —Ç –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: 'ü¶¨'},
        {id: 'v10t', title: '–¢–∏—Ç–∞–Ω', description: '–ü–æ–¥–Ω—è—Ç—å >10 —Ç –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: '‚ö°'},
        {id: 'v20t', title: '–ì–µ—Ä–∫—É–ª–µ—Å', description: '–ü–æ–¥–Ω—è—Ç—å >20 —Ç –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: 'üî•'},
        {id: 'v40t', title: '–°–≤–µ—Ä—Ö—á–µ–ª–æ–≤–µ–∫', description: '–ü–æ–¥–Ω—è—Ç—å >40 —Ç –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', icon: 'üíé'}
      ]},
      {name: '–û–±—â–∏–π –ø–æ–¥–Ω—è—Ç—ã–π –≤–µ—Å', achievements: [
        {id: 't50t', title: '–ù–∞—á–∏–Ω–∞—é—â–∏–π –∞—Ç–ª–µ—Ç', description: '–û–±—â–∏–π —Ç–æ–Ω–Ω–∞–∂ >50 —Ç', icon: 'üéØ'},
        {id: 't100t', title: '–¢–æ–Ω–Ω—ã–π –∫–ª—É–±', description: '–û–±—â–∏–π —Ç–æ–Ω–Ω–∞–∂ >100 —Ç', icon: 'üè≠'},
        {id: 't250t', title: '–°—Ç–∞–ª—å–Ω–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä', description: '–û–±—â–∏–π —Ç–æ–Ω–Ω–∞–∂ >250 —Ç', icon: 'üî®'},
        {id: 't500t', title: '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä —Ç–µ–ª–∞', description: '–û–±—â–∏–π —Ç–æ–Ω–Ω–∞–∂ >500 —Ç', icon: 'üèõÔ∏è'},
        {id: 't1000t', title: '–ü–æ–∫–æ—Ä–∏—Ç–µ–ª—å –≤–µ—Ä—à–∏–Ω', description: '–û–±—â–∏–π —Ç–æ–Ω–Ω–∞–∂ >1000 —Ç', icon: 'üèîÔ∏è'}
      ]}
    ];

    function App() {
      const [activeTab, setActiveTab] = useState('workout');
      const [exercises, setExercises] = useState([]);
      const [workouts, setWorkouts] = useState([]);
      const [templates, setTemplates] = useState([]);
      const [currentWorkout, setCurrentWorkout] = useState(null);
      const [timerSeconds, setTimerSeconds] = useState(0);
      const [isTimerRunning, setIsTimerRunning] = useState(false);
      const [unlockedAchievements, setUnlockedAchievements] = useState([]);

      useEffect(() => {
        const initExercises = [];
        let id = 1;
        for (const [group, exList] of Object.entries(exerciseDatabase)) {
          exList.forEach(name => initExercises.push({ id: id++, name, group, system: true }));
        }
        
        const saved = localStorage.getItem('gym_exercises');
        if (saved) {
          const userExercises = JSON.parse(saved).filter(ex => !ex.system);
          userExercises.forEach(ex => initExercises.push({ ...ex, id: id++ }));
        }
        
        setExercises(initExercises);
        
        const savedWorkouts = localStorage.getItem('gym_workouts');
        if (savedWorkouts) setWorkouts(JSON.parse(savedWorkouts));
        
        const savedTemplates = localStorage.getItem('gym_templates');
        if (savedTemplates) setTemplates(JSON.parse(savedTemplates));

        const savedAchievements = localStorage.getItem('gym_achievements');
        if (savedAchievements) setUnlockedAchievements(JSON.parse(savedAchievements));
      }, []);

      useEffect(() => {
        let interval;
        if (isTimerRunning && currentWorkout) {
          interval = setInterval(() => {
            setTimerSeconds(s => s + 1);
          }, 1000);
        }
        return () => clearInterval(interval);
      }, [isTimerRunning, currentWorkout]);

      useEffect(() => {
        localStorage.setItem('gym_exercises', JSON.stringify(exercises.filter(e => !e.system)));
        localStorage.setItem('gym_workouts', JSON.stringify(workouts));
        localStorage.setItem('gym_templates', JSON.stringify(templates));
        localStorage.setItem('gym_achievements', JSON.stringify(unlockedAchievements));
      }, [exercises, workouts, templates, unlockedAchievements]);

      const formatTime = (seconds) => {
        const h = Math.floor(seconds / 3600);
        const m = Math.floor((seconds % 3600) / 60);
        const s = seconds % 60;
        return `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
      };

      const startNewWorkout = () => {
        const workout = {
          id: Date.now(),
          startDate: new Date().toISOString(),
          endDate: null,
          templateName: '–°–≤–æ–±–æ–¥–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞',
          bodyWeightBefore: null,
          bodyWeightAfter: null,
          overallMood: null,
          exercises: []
        };
        setCurrentWorkout(workout);
        setIsTimerRunning(true);
        setTimerSeconds(0);
      };

      const startFromTemplate = (templateId) => {
        const template = templates.find(t => t.id === templateId);
        if (!template) return;

        const workout = {
          id: Date.now(),
          startDate: new Date().toISOString(),
          endDate: null,
          templateName: template.name,
          bodyWeightBefore: null,
          bodyWeightAfter: null,
          overallMood: null,
          exercises: template.exercises.map(ex => ({
            exerciseId: ex.exerciseId,
            exerciseName: ex.exerciseName,
            sets: []
          }))
        };
        setCurrentWorkout(workout);
        setIsTimerRunning(true);
        setTimerSeconds(0);
        setActiveTab('workout');
      };

      const checkAndUnlockAchievements = (lastWorkout) => {
        const getWorkoutVolume = (w) => 
          w.exercises.reduce((s, e) => s + e.sets.reduce((a, st) => a + st.weight * st.reps, 0), 0);
        
        const getTotalVolume = (ww) => 
          ww.reduce((t, w) => t + getWorkoutVolume(w), 0);

        const lastVolume = getWorkoutVolume(lastWorkout);
        const totalVol = getTotalVolume(workouts);

        const checks = [
          { id: 'c1', condition: workouts.length >= 1 },
          { id: 'c10', condition: workouts.length >= 10 },
          { id: 'c50', condition: workouts.length >= 50 },
          { id: 'c100', condition: workouts.length >= 100 },
          { id: 'c200', condition: workouts.length >= 200 },
          { id: 'c400', condition: workouts.length >= 400 },
          { id: 'c800', condition: workouts.length >= 800 },
          { id: 'v1t', condition: lastVolume > 1000 },
          { id: 'v2t', condition: lastVolume > 2000 },
          { id: 'v5t', condition: lastVolume > 5000 },
          { id: 'v10t', condition: lastVolume > 10000 },
          { id: 'v20t', condition: lastVolume > 20000 },
          { id: 'v40t', condition: lastVolume > 40000 },
          { id: 't50t', condition: totalVol > 50000 },
          { id: 't100t', condition: totalVol > 100000 },
          { id: 't250t', condition: totalVol > 250000 },
          { id: 't500t', condition: totalVol > 500000 },
          { id: 't1000t', condition: totalVol > 1000000 }
        ];

        const newly = [];
        checks.forEach(check => {
          if (!unlockedAchievements.includes(check.id) && check.condition) {
            newly.push(check.id);
          }
        });

        if (newly.length > 0) {
          setUnlockedAchievements([...unlockedAchievements, ...newly]);
          const achievementNames = newly.map(id => {
            for (const cat of ACHIEVEMENT_CATEGORIES) {
              const ach = cat.achievements.find(a => a.id === id);
              if (ach) return ach.title;
            }
            return '';
          }).filter(Boolean);
          
          setTimeout(() => {
            alert(`üéâ –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!\n\n${achievementNames.join(', ')}`);
          }, 500);
        }
      };

      const finishWorkout = () => {
        if (!currentWorkout) return;
        
        const filtered = currentWorkout.exercises.filter(e => e.sets.length > 0);
        if (filtered.length === 0) {
          alert('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–æ–¥—Ö–æ–¥');
          return;
        }

        const mood = prompt('–û—Ü–µ–Ω–∏—Ç–µ –æ–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (1-5):', '3');
        const overallMood = mood ? Math.min(5, Math.max(1, parseInt(mood) || 3)) : 3;

        const finished = {
          ...currentWorkout,
          exercises: filtered,
          endDate: new Date().toISOString(),
          overallMood
        };

        const updated = [...workouts, finished];
        setWorkouts(updated);
        
        setIsTimerRunning(false);
        setTimerSeconds(0);
        
        setCurrentWorkout(null);
        
        checkAndUnlockAchievements(finished);
        
        alert('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! üí™');
      };

      const exportData = () => {
        const data = {
          exercises: exercises.filter(e => !e.system),
          workouts,
          templates,
          exportDate: new Date().toISOString()
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `gym-tracker-backup-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        alert('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã! üì•');
      };

      const resetAllData = () => {
        if (!confirm('‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n–≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ. –í—ã —É–≤–µ—Ä–µ–Ω—ã?')) return;
        
        if (confirm('–•–æ—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?')) {
          exportData();
          setTimeout(() => {
            if (confirm('–¢–µ–ø–µ—Ä—å —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')) {
              localStorage.clear();
              window.location.reload();
            }
          }, 1000);
        } else {
          if (confirm('–ü–û–°–õ–ï–î–ù–ï–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï! –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
            localStorage.clear();
            window.location.reload();
          }
        }
      };

      return (
        <div>
          <header className="header">
            <div className="header-content">
              <div className="logo">
                <div className="logo-icon">üí™</div>
                <div className="logo-text">
                  <h1>GymFlow</h1>
                  <p>–¢—Ä–µ–∫–µ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</p>
                </div>
              </div>
              
              {isTimerRunning && (
                <div className="timer-display">
                  <span className="timer-icon">‚è±Ô∏è</span>
                  <span className="timer-text">{formatTime(timerSeconds)}</span>
                </div>
              )}
            </div>
          </header>

          <div className="container">
            <nav className="nav">
              <div className="nav-buttons">
                <button className={`nav-btn ${activeTab === 'workout' ? 'active' : ''}`} onClick={() => setActiveTab('workout')}>
                  <span>üí™</span> –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
                </button>
                <button className={`nav-btn ${activeTab === 'templates' ? 'active' : ''}`} onClick={() => setActiveTab('templates')}>
                  <span>üìÖ</span> –®–∞–±–ª–æ–Ω—ã
                </button>
                <button className={`nav-btn ${activeTab === 'history' ? 'active' : ''}`} onClick={() => setActiveTab('history')}>
                  <span>üìà</span> –ò—Å—Ç–æ—Ä–∏—è
                </button>
                <button className={`nav-btn ${activeTab === 'stats' ? 'active' : ''}`} onClick={() => setActiveTab('stats')}>
                  <span>üìä</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </button>
                <button className={`nav-btn ${activeTab === 'achievements' ? 'active' : ''}`} onClick={() => setActiveTab('achievements')}>
                  <span>üèÜ</span> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                </button>
                <button className={`nav-btn ${activeTab === 'settings' ? 'active' : ''}`} onClick={() => setActiveTab('settings')}>
                  <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
              </div>
            </nav>

            <main>
              {activeTab === 'workout' && (
                <WorkoutTab
                  currentWorkout={currentWorkout}
                  exercises={exercises}
                  onStartWorkout={startNewWorkout}
                  onFinishWorkout={finishWorkout}
                  onUpdateWorkout={setCurrentWorkout}
                />
              )}
              
              {activeTab === 'templates' && (
                <TemplatesTab
                  templates={templates}
                  exercises={exercises}
                  onSaveTemplate={(template) => {
                    if (template.id && templates.find(t => t.id === template.id)) {
                      setTemplates(templates.map(t => t.id === template.id ? template : t));
                    } else {
                      setTemplates([...templates, { ...template, id: Date.now(), createdAt: new Date().toISOString() }]);
                    }
                  }}
                  onDeleteTemplate={(id) => setTemplates(templates.filter(t => t.id !== id))}
                  onStartFromTemplate={startFromTemplate}
                />
              )}
              
              {activeTab === 'history' && (
                <HistoryTab workouts={workouts} exercises={exercises} />
              )}
              
              {activeTab === 'stats' && (
                <StatsTab workouts={workouts} exercises={exercises} />
              )}
              
              {activeTab === 'achievements' && (
                <AchievementsTab unlockedAchievements={unlockedAchievements} />
              )}
              
              {activeTab === 'settings' && (
                <SettingsTab
                  exercises={exercises}
                  onAddExercise={(name) => {
                    const id = Date.now();
                    setExercises([...exercises, { id, name, group: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ', system: false }]);
                  }}
                  onDeleteExercise={(id) => {
                    const ex = exercises.find(e => e.id === id);
                    if (ex?.system) {
                      alert('–°–∏—Å—Ç–µ–º–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —É–¥–∞–ª—è—Ç—å –Ω–µ–ª—å–∑—è');
                      return;
                    }
                    const used = templates.some(t => t.exercises.some(e => e.exerciseId === id));
                    if (used) {
                      alert('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –≤ —à–∞–±–ª–æ–Ω–∞—Ö');
                      return;
                    }
                    if (confirm(`–£–¥–∞–ª–∏—Ç—å ¬´${ex?.name}¬ª?`)) {
                      setExercises(exercises.filter(e => e.id !== id));
                    }
                  }}
                  onExportData={exportData}
                  onResetData={resetAllData}
                />
              )}
            </main>
          </div>
        </div>
      );
    }

    function WorkoutTab({ currentWorkout, exercises, onStartWorkout, onFinishWorkout, onUpdateWorkout }) {
      const [showExerciseModal, setShowExerciseModal] = useState(false);
      const [showSetModal, setShowSetModal] = useState(false);
      const [showBodyWeightModal, setShowBodyWeightModal] = useState(false);
      const [bodyWeightType, setBodyWeightType] = useState('before');
      const [selectedExerciseId, setSelectedExerciseId] = useState(null);
      const [weight, setWeight] = useState(50);
      const [reps, setReps] = useState(10);
      const [mood, setMood] = useState(3);
      const [bodyWeight, setBodyWeight] = useState(70);

      const addExerciseToWorkout = (exerciseId) => {
        if (!currentWorkout) return;
        
        const exercise = exercises.find(e => e.id === exerciseId);
        if (!exercise) return;

        const exists = currentWorkout.exercises.find(e => e.exerciseId === exerciseId);
        if (exists) {
          alert('–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ');
          return;
        }

        onUpdateWorkout({
          ...currentWorkout,
          exercises: [...currentWorkout.exercises, {
            exerciseId: exercise.id,
            exerciseName: exercise.name,
            sets: []
          }]
        });
        setShowExerciseModal(false);
      };

      const addSet = () => {
        if (!currentWorkout || selectedExerciseId === null) return;

        const updated = {
          ...currentWorkout,
          exercises: currentWorkout.exercises.map(ex =>
            ex.exerciseId === selectedExerciseId
              ? {
                  ...ex,
                  sets: [...ex.sets, { weight, reps, mood, timestamp: Date.now() }]
                }
              : ex
          )
        };
        onUpdateWorkout(updated);
        setShowSetModal(false);
      };

      const addSetSameAsPrevious = () => {
        if (!currentWorkout || selectedExerciseId === null) return;
        const ex = currentWorkout.exercises.find(e => e.exerciseId === selectedExerciseId);
        if (!ex || ex.sets.length === 0) {
          alert('–ù–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤');
          return;
        }
        const lastSet = ex.sets[ex.sets.length - 1];
        const updated = {
          ...currentWorkout,
          exercises: currentWorkout.exercises.map(e =>
            e.exerciseId === selectedExerciseId
              ? { ...e, sets: [...e.sets, { ...lastSet, timestamp: Date.now() }] }
              : e
          )
        };
        onUpdateWorkout(updated);
        setShowSetModal(false);
      };

      const deleteSet = (exerciseId, setIndex) => {
        if (!confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ–¥—Ö–æ–¥?')) return;
        if (!currentWorkout) return;
        
        const updated = {
          ...currentWorkout,
          exercises: currentWorkout.exercises.map(ex =>
            ex.exerciseId === exerciseId
              ? { ...ex, sets: ex.sets.filter((_, i) => i !== setIndex) }
              : ex
          )
        };
        onUpdateWorkout(updated);
      };

      const openSetModal = (exerciseId) => {
        setSelectedExerciseId(exerciseId);
        const exercise = currentWorkout?.exercises.find(e => e.exerciseId === exerciseId);
        if (exercise && exercise.sets.length > 0) {
          const lastSet = exercise.sets[exercise.sets.length - 1];
          setWeight(lastSet.weight);
          setReps(lastSet.reps);
          setMood(lastSet.mood);
        } else {
          setWeight(50);
          setReps(10);
          setMood(3);
        }
        setShowSetModal(true);
      };

      const openBodyWeightModal = (type) => {
        setBodyWeightType(type);
        const current = type === 'before' ? currentWorkout?.bodyWeightBefore : currentWorkout?.bodyWeightAfter;
        setBodyWeight(current || 70);
        setShowBodyWeightModal(true);
      };

      const saveBodyWeight = () => {
        if (!currentWorkout) return;
        if (bodyWeightType === 'before') {
          onUpdateWorkout({ ...currentWorkout, bodyWeightBefore: bodyWeight });
        } else {
          onUpdateWorkout({ ...currentWorkout, bodyWeightAfter: bodyWeight });
        }
        setShowBodyWeightModal(false);
      };

      const getMoodEmoji = (m) => m === 1 ? 'üò´' : m === 5 ? 'üòÑ' : 'üòê';

      if (!currentWorkout) {
        return (
          <div className="card empty-state">
            <div className="empty-icon">üí™</div>
            <h2 className="empty-title">–ù–∞—á–Ω–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</h2>
            <p style={{marginBottom: '2rem'}}>–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω</p>
            <button onClick={onStartWorkout} className="btn btn-primary btn-large">
              –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            </button>
          </div>
        );
      }

      return (
        <div>
          <div className="card" style={{background: 'linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)', border: '1px solid #93c5fd'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1rem'}}>
              <span style={{fontSize: '20px'}}>‚öñÔ∏è</span>
              <h3 style={{fontWeight: 600, color: '#0f172a'}}>–í–µ—Å —Ç–µ–ª–∞</h3>
            </div>
            <div className="grid" style={{gridTemplateColumns: 'repeat(2, 1fr)'}}>
              <div style={{background: 'white', borderRadius: '12px', padding: '1rem'}}>
                <p style={{fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem'}}>–î–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
                {currentWorkout.bodyWeightBefore ? (
                  <p style={{fontSize: '1.5rem', fontWeight: 700, color: '#0f172a'}}>{currentWorkout.bodyWeightBefore.toFixed(1)} –∫–≥</p>
                ) : (
                  <button onClick={() => openBodyWeightModal('before')} className="btn btn-secondary" style={{fontSize: '0.875rem'}}>
                    –£–∫–∞–∑–∞—Ç—å –≤–µ—Å
                  </button>
                )}
              </div>
              <div style={{background: 'white', borderRadius: '12px', padding: '1rem'}}>
                <p style={{fontSize: '0.875rem', color: '#64748b', marginBottom: '0.5rem'}}>–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
                {currentWorkout.bodyWeightAfter ? (
                  <p style={{fontSize: '1.5rem', fontWeight: 700, color: '#0f172a'}}>{currentWorkout.bodyWeightAfter.toFixed(1)} –∫–≥</p>
                ) : (
                  <button onClick={() => openBodyWeightModal('after')} className="btn btn-secondary" style={{fontSize: '0.875rem'}}>
                    –£–∫–∞–∑–∞—Ç—å –≤–µ—Å
                  </button>
                )}
              </div>
            </div>
          </div>

          <div className="card">
            <div className="card-header">
              <h3 style={{fontSize: '1.25rem', fontWeight: 700}}>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
              <button onClick={() => setShowExerciseModal(true)} className="btn btn-primary">
                <span>‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å
              </button>
            </div>

            {currentWorkout.exercises.length === 0 ? (
              <div className="empty-state">
                <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</p>
              </div>
            ) : (
              <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
                {currentWorkout.exercises.map(ex => {
                  const firstSet = ex.sets[0];
                  const lastSet = ex.sets[ex.sets.length - 1];
                  const duration = firstSet && lastSet ? Math.round((lastSet.timestamp - firstSet.timestamp) / 60000) : 0;

                  return (
                    <div key={ex.exerciseId} className="exercise-item">
                      <div style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '1rem'}}>
                        <h4 style={{fontWeight: 600, color: '#0f172a'}}>{ex.exerciseName}</h4>
                        <span style={{fontSize: '0.875rem', color: '#64748b'}}>
                          {ex.sets.length} –ø–æ–¥—Ö–æ–¥–æ–≤{duration > 0 && ` ‚Ä¢ ${duration} –º–∏–Ω`}
                        </span>
                      </div>

                      {ex.sets.map((set, idx) => (
                        <div key={idx} className="set-item">
                          <div style={{display: 'flex', alignItems: 'center', gap: '1rem'}}>
                            <span style={{fontFamily: 'monospace', fontSize: '0.875rem', fontWeight: 600, color: '#94a3b8'}}>#{idx + 1}</span>
                            <div>
                              <span style={{fontWeight: 600, color: '#0f172a'}}>{set.weight} –∫–≥ √ó {set.reps} –ø–æ–≤—Ç.</span>
                              <p style={{fontSize: '0.75rem', color: '#64748b', marginTop: '0.25rem'}}>
                                {new Date(set.timestamp).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}
                              </p>
                            </div>
                          </div>
                          <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                            <span style={{fontSize: '1.25rem'}}>{getMoodEmoji(set.mood)}</span>
                            <button onClick={() => deleteSet(ex.exerciseId, idx)} style={{background: 'none', border: 'none', color: '#ef4444', cursor: 'pointer', fontSize: '1.25rem'}}>
                              ‚úñÔ∏è
                            </button>
                          </div>
                        </div>
                      ))}

                      <button onClick={() => openSetModal(ex.exerciseId)} className="btn btn-success" style={{width: '100%', marginTop: '0.75rem'}}>
                        + –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥
                      </button>
                    </div>
                  );
                })}
              </div>
            )}
          </div>

          <div style={{display: 'flex', gap: '1rem'}}>
            <button onClick={onFinishWorkout} className="btn btn-primary btn-large" style={{flex: 1}}>
              –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            </button>
            <button
              onClick={() => {
                if (confirm('–û—Ç–º–µ–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É? –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
                  onUpdateWorkout(null);
                }
              }}
              className="btn btn-secondary btn-large"
            >
              –û—Ç–º–µ–Ω–∏—Ç—å
            </button>
          </div>

          {showExerciseModal && (
            <Modal onClose={() => setShowExerciseModal(false)} title="–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ">
              <div style={{display: 'flex', flexDirection: 'column', gap: '1.5rem', maxHeight: '60vh', overflowY: 'auto'}}>
                {Object.entries(exerciseDatabase).map(([group, exList]) => (
                  <div key={group}>
                    <h4 style={{fontWeight: 600, color: '#475569', marginBottom: '0.75rem', textTransform: 'uppercase', fontSize: '0.875rem'}}>{group}</h4>
                    <div style={{display: 'flex', flexDirection: 'column', gap: '0.5rem'}}>
                      {exList.map(exName => {
                        const exercise = exercises.find(e => e.name === exName);
                        return exercise ? (
                          <button
                            key={exercise.id}
                            onClick={() => addExerciseToWorkout(exercise.id)}
                            style={{width: '100%', textAlign: 'left', padding: '0.75rem 1rem', borderRadius: '8px', border: '1px solid #e2e8f0', background: 'white', cursor: 'pointer', color: '#475569', transition: 'all 0.2s'}}
                            onMouseOver={e => {e.target.style.background = '#eff6ff'; e.target.style.borderColor = '#93c5fd'}}
                            onMouseOut={e => {e.target.style.background = 'white'; e.target.style.borderColor = '#e2e8f0'}}
                          >
                            {exercise.name}
                          </button>
                        ) : null;
                      })}
                    </div>
                  </div>
                ))}
              </div>
            </Modal>
          )}

          {showSetModal && (
            <Modal onClose={() => setShowSetModal(false)} title="–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥">
              <div style={{display: 'flex', flexDirection: 'column', gap: '1.5rem'}}>
                <div className="form-group">
                  <label className="label">–í–µ—Å (–∫–≥)</label>
                  <div className="counter">
                    <button onClick={() => setWeight(Math.max(0, weight - 2.5))} className="counter-btn">‚àí</button>
                    <input type="number" value={weight} onChange={e => setWeight(Number(e.target.value))} step="2.5" className="counter-input" />
                    <button onClick={() => setWeight(weight + 2.5)} className="counter-btn">+</button>
                  </div>
                </div>

                <div className="form-group">
                  <label className="label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
                  <div className="counter">
                    <button onClick={() => setReps(Math.max(1, reps - 1))} className="counter-btn">‚àí</button>
                    <input type="number" value={reps} onChange={e => setReps(Number(e.target.value))} className="counter-input" />
                    <button onClick={() => setReps(reps + 1)} className="counter-btn">+</button>
                  </div>
                </div>

                <div className="form-group">
                  <label className="label">–ö–∞–∫ —Å–µ–±—è —á—É–≤—Å—Ç–≤—É–µ—Ç–µ?</label>
                  <div className="mood-selector">
                    {[1, 3, 5].map(m => (
                      <button
                        key={m}
                        onClick={() => setMood(m)}
                        className={`mood-btn ${mood === m ? 'selected' : ''}`}
                      >
                        {m === 5 ? 'üòÑ' : m === 3 ? 'üòê' : 'üò´'}
                      </button>
                    ))}
                  </div>
                </div>

                <div style={{display: 'flex', gap: '0.75rem'}}>
                  <button onClick={addSet} className="btn btn-primary" style={{flex: 1, padding: '0.75rem'}}>
                    –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥
                  </button>
                  <button onClick={addSetSameAsPrevious} className="btn btn-secondary" style={{flex: 1, padding: '0.75rem'}}>
                    –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π
                  </button>
                </div>
              </div>
            </Modal>
          )}

          {showBodyWeightModal && (
            <Modal onClose={() => setShowBodyWeightModal(false)} title={bodyWeightType === 'before' ? '–í–µ—Å –¥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏' : '–í–µ—Å –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏'}>
              <div style={{display: 'flex', flexDirection: 'column', gap: '1.5rem'}}>
                <div className="form-group">
                  <label className="label">–í–∞—à –≤–µ—Å (–∫–≥)</label>
                  <div className="counter">
                    <button onClick={() => setBodyWeight(Math.max(0, bodyWeight - 0.5))} className="counter-btn">‚àí</button>
                    <input type="number" value={bodyWeight} onChange={e => setBodyWeight(Number(e.target.value))} step="0.5" className="counter-input" />
                    <button onClick={() => setBodyWeight(bodyWeight + 0.5)} className="counter-btn">+</button>
                  </div>
                </div>

                <button onClick={saveBodyWeight} className="btn btn-primary" style={{padding: '0.75rem'}}>
                  –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
              </div>
            </Modal>
          )}
        </div>
      );
    }

    function TemplatesTab({ templates, exercises, onSaveTemplate, onDeleteTemplate, onStartFromTemplate }) {
      const [showModal, setShowModal] = useState(false);
      const [showViewModal, setShowViewModal] = useState(false);
      const [editingTemplate, setEditingTemplate] = useState(null);
      const [viewingTemplate, setViewingTemplate] = useState(null);
      const [templateName, setTemplateName] = useState('');
      const [selectedExercises, setSelectedExercises] = useState(new Set());
      const [searchQuery, setSearchQuery] = useState('');

      const openCreateModal = () => {
        setEditingTemplate(null);
        setTemplateName('');
        setSelectedExercises(new Set());
        setSearchQuery('');
        setShowModal(true);
      };

      const openEditModal = (template) => {
        setEditingTemplate(template);
        setTemplateName(template.name);
        setSelectedExercises(new Set(template.exercises.map(e => e.exerciseId)));
        setSearchQuery('');
        setShowModal(true);
      };

      const openViewModal = (template) => {
        setViewingTemplate(template);
        setShowViewModal(true);
      };

      const saveTemplate = () => {
        if (!templateName.trim()) {
          alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏');
          return;
        }
        if (selectedExercises.size === 0) {
          alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ');
          return;
        }

        const template = {
          id: editingTemplate?.id || Date.now(),
          name: templateName,
          exercises: Array.from(selectedExercises).map(id => {
            const ex = exercises.find(e => e.id === id);
            return { exerciseId: id, exerciseName: ex.name };
          }),
          createdAt: editingTemplate?.createdAt || new Date().toISOString()
        };

        onSaveTemplate(template);
        setShowModal(false);
        alert(`–®–∞–±–ª–æ–Ω ¬´${templateName}¬ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω!`);
      };

      const filteredExercises = searchQuery
        ? exercises.filter(e => e.name.toLowerCase().includes(searchQuery.toLowerCase()))
        : exercises;

      const groupedExercises = {};
      filteredExercises.forEach(ex => {
        const group = ex.group || '–ü—Ä–æ—á–∏–µ';
        if (!groupedExercises[group]) groupedExercises[group] = [];
        groupedExercises[group].push(ex);
      });

      return (
        <div>
          <div className="card">
            <div className="card-header">
              <h2 className="card-title">–®–∞–±–ª–æ–Ω—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h2>
              <button onClick={openCreateModal} className="btn btn-primary">
                <span>‚ûï</span> –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω
              </button>
            </div>

            {templates.length === 0 ? (
              <div className="empty-state">
                <div className="empty-icon">üìÖ</div>
                <h3 className="empty-title">–ù–µ—Ç —à–∞–±–ª–æ–Ω–æ–≤</h3>
                <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —à–∞–±–ª–æ–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
              </div>
            ) : (
              <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
                {templates.map(template => (
                  <div key={template.id} className="exercise-item">
                    <div style={{display: 'flex', alignItems: 'flex-start', justifyContent: 'space-between', marginBottom: '0.75rem'}}>
                      <div style={{flex: 1}}>
                        <h3 style={{fontWeight: 600, fontSize: '1.125rem', color: '#0f172a', marginBottom: '0.25rem'}}>{template.name}</h3>
                        <p style={{fontSize: '0.875rem', color: '#64748b'}}>{template.exercises.length} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</p>
                      </div>
                      <button onClick={() => { if (confirm('–£–¥–∞–ª–∏—Ç—å —à–∞–±–ª–æ–Ω?')) { onDeleteTemplate(template.id); } }} style={{background: 'none', border: 'none', color: '#ef4444', cursor: 'pointer', fontSize: '1.25rem'}}>
                        üóëÔ∏è
                      </button>
                    </div>
                    <p style={{fontSize: '0.875rem', color: '#64748b', marginBottom: '1rem'}}>
                      {template.exercises.map(e => e.exerciseName).join(', ')}
                    </p>
                    <div style={{display: 'flex', gap: '0.5rem', flexWrap: 'wrap'}}>
                      <button onClick={() => openViewModal(template)} className="btn btn-secondary" style={{fontSize: '0.875rem'}}>
                        <span>üëÅÔ∏è</span> –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å
                      </button>
                      <button onClick={() => openEditModal(template)} className="btn btn-secondary" style={{fontSize: '0.875rem'}}>
                        <span>‚úèÔ∏è</span> –ò–∑–º–µ–Ω–∏—Ç—å
                      </button>
                      <button onClick={() => onStartFromTemplate(template.id)} className="btn btn-success" style={{fontSize: '0.875rem', marginLeft: 'auto'}}>
                        <span>‚ñ∂Ô∏è</span> –ù–∞—á–∞—Ç—å
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>

          {showModal && (
            <Modal onClose={() => setShowModal(false)} title={editingTemplate ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω' : '–°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏'}>
              <div style={{display: 'flex', flexDirection: 'column', gap: '1.5rem'}}>
                <div className="form-group">
                  <label className="label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</label>
                  <input type="text" value={templateName} onChange={e => setTemplateName(e.target.value)} placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ì—Ä—É–¥—å –∏ —Ç—Ä–∏—Ü–µ–ø—Å" className="input" />
                </div>

                <div className="form-group">
                  <label className="label">–ü–æ–∏—Å–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</label>
                  <input type="text" value={searchQuery} onChange={e => setSearchQuery(e.target.value)} placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è..." className="input" />
                </div>

                <div className="form-group">
                  <label className="label">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</label>
                  <div style={{maxHeight: '400px', overflowY: 'auto', border: '2px solid #e2e8f0', borderRadius: '8px', padding: '1rem'}}>
                    {Object.entries(groupedExercises).map(([group, exList]) => (
                      <div key={group} style={{marginBottom: '1rem'}}>
                        <h4 style={{fontWeight: 600, color: '#475569', marginBottom: '0.5rem', textTransform: 'uppercase', fontSize: '0.75rem'}}>{group}</h4>
                        <div style={{display: 'flex', flexDirection: 'column', gap: '0.25rem'}}>
                          {exList.map(ex => (
                            <label key={ex.id} style={{display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '0.5rem', borderRadius: '8px', cursor: 'pointer'}}>
                              <input
                                type="checkbox"
                                checked={selectedExercises.has(ex.id)}
                                onChange={e => {
                                  const newSet = new Set(selectedExercises);
                                  if (e.target.checked) {
                                    newSet.add(ex.id);
                                  } else {
                                    newSet.delete(ex.id);
                                  }
                                  setSelectedExercises(newSet);
                                }}
                                style={{width: '16px', height: '16px'}}
                              />
                              <span style={{color: '#475569'}}>{ex.name}</span>
                              {!ex.system && <span style={{fontSize: '0.75rem', color: '#94a3b8'}}>(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ)</span>}
                            </label>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>

                <div style={{display: 'flex', gap: '0.75rem', flexWrap: 'wrap'}}>
                  <button onClick={saveTemplate} className="btn btn-primary" style={{flex: 1, padding: '0.75rem'}}>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                  </button>
                  <button onClick={() => setShowModal(false)} className="btn btn-secondary" style={{padding: '0.75rem'}}>
                    –û—Ç–º–µ–Ω–∞
                  </button>
                </div>
              </div>
            </Modal>
          )}

          {showViewModal && viewingTemplate && (
            <Modal onClose={() => setShowViewModal(false)} title={viewingTemplate.name}>
              <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
                <div style={{display: 'flex', flexDirection: 'column', gap: '0.5rem'}}>
                  {viewingTemplate.exercises.map((ex, idx) => (
                    <div key={idx} style={{display: 'flex', alignItems: 'center', gap: '0.75rem', padding: '0.75rem', background: '#f8fafc', borderRadius: '8px'}}>
                      <span style={{fontFamily: 'monospace', fontSize: '0.875rem', fontWeight: 600, color: '#94a3b8'}}>#{idx + 1}</span>
                      <span style={{color: '#0f172a'}}>{ex.exerciseName}</span>
                    </div>
                  ))}
                </div>

                <div style={{display: 'flex', gap: '0.75rem', paddingTop: '1rem', flexWrap: 'wrap'}}>
                  <button onClick={() => { setShowViewModal(false); onStartFromTemplate(viewingTemplate.id); }} className="btn btn-primary" style={{flex: 1, padding: '0.75rem'}}>
                    –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                  </button>
                  <button onClick={() => setShowViewModal(false)} className="btn btn-secondary" style={{padding: '0.75rem'}}>
                    –ó–∞–∫—Ä—ã—Ç—å
                  </button>
                </div>
              </div>
            </Modal>
          )}
        </div>
      );
    }

    function HistoryTab({ workouts, exercises }) {
      const [expandedId, setExpandedId] = useState(null);

      const getMoodEmoji = (m) => m === 1 ? 'üò´' : m === 5 ? 'üòÑ' : 'üòê';

      if (workouts.length === 0) {
        return (
          <div className="card empty-state">
            <div className="empty-icon">üìà</div>
            <h3 className="empty-title">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</h3>
            <p>–ó–∞–≤–µ—Ä—à–∏—Ç–µ –ø–µ—Ä–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</p>
          </div>
        );
      }

      return (
        <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
          {[...workouts].reverse().map(workout => {
            const start = new Date(workout.startDate);
            const end = workout.endDate ? new Date(workout.endDate) : null;
            const duration = end ? Math.round((end.getTime() - start.getTime()) / 60000) : 0;
            const totalSets = workout.exercises.reduce((sum, ex) => sum + ex.sets.length, 0);
            const totalVolume = workout.exercises.reduce(
              (sum, ex) => sum + ex.sets.reduce((s, set) => s + set.weight * set.reps, 0),
              0
            );

            return (
              <div key={workout.id} className="card" style={{padding: 0, overflow: 'hidden'}}>
                <button
                  onClick={() => setExpandedId(expandedId === workout.id ? null : workout.id)}
                  style={{width: '100%', padding: '1.5rem', textAlign: 'left', background: 'none', border: 'none', cursor: 'pointer'}}
                >
                  <div style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem'}}>
                    <div style={{display: 'flex', alignItems: 'center', gap: '0.75rem'}}>
                      <span style={{fontWeight: 600, color: '#0f172a'}}>
                        {start.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long' })}
                      </span>
                      {workout.overallMood && (
                        <span style={{fontSize: '1.25rem'}}>{getMoodEmoji(workout.overallMood)}</span>
                      )}
                    </div>
                    <span style={{fontSize: '1.25rem', color: '#94a3b8', transition: 'transform 0.2s', transform: expandedId === workout.id ? 'rotate(180deg)' : 'rotate(0deg)'}}>
                      üîΩ
                    </span>
                  </div>
                  <p style={{fontSize: '0.875rem', color: '#64748b', fontWeight: 500, marginBottom: '0.5rem'}}>{workout.templateName}</p>
                  <div style={{display: 'flex', flexWrap: 'wrap', gap: '0.75rem', fontSize: '0.875rem', color: '#64748b'}}>
                    <span>{start.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}</span>
                    {end && <><span>‚Ä¢</span><span>{end.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}</span></>}
                    <span>‚Ä¢</span>
                    <span>{workout.exercises.length} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</span>
                    <span>‚Ä¢</span>
                    <span>{totalSets} –ø–æ–¥—Ö–æ–¥–æ–≤</span>
                    <span>‚Ä¢</span>
                    <span>{(totalVolume / 1000).toFixed(1)} —Ç–æ–Ω–Ω</span>
                    {duration > 0 && <><span>‚Ä¢</span><span>{duration} –º–∏–Ω</span></>}
                    {workout.bodyWeightAfter && <><span>‚Ä¢</span><span>{workout.bodyWeightAfter.toFixed(1)} –∫–≥</span></>}
                  </div>
                </button>

                {expandedId === workout.id && (
                  <div style={{padding: '0 1.5rem 1.5rem 1.5rem', borderTop: '1px solid #f1f5f9', paddingTop: '1rem', display: 'flex', flexDirection: 'column', gap: '0.75rem'}}>
                    {workout.exercises.map(ex => (
                      <div key={ex.exerciseId} style={{background: '#f8fafc', borderRadius: '8px', padding: '1rem'}}>
                        <h4 style={{fontWeight: 500, color: '#0f172a', marginBottom: '0.5rem'}}>{ex.exerciseName}</h4>
                        <div style={{display: 'flex', flexDirection: 'column', gap: '0.25rem'}}>
                          {ex.sets.map((set, idx) => (
                            <div key={idx} style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', fontSize: '0.875rem'}}>
                              <div>
                                <span style={{color: '#64748b'}}>
                                  {idx + 1}. {set.weight} –∫–≥ √ó {set.reps} –ø–æ–≤—Ç.
                                </span>
                                <span style={{fontSize: '0.75rem', color: '#94a3b8', marginLeft: '0.5rem'}}>
                                  {new Date(set.timestamp).toLocaleTimeString('ru-RU')}
                                </span>
                              </div>
                              {set.mood && <span>{getMoodEmoji(set.mood)}</span>}
                            </div>
                          ))}
                        </div>
                      </div>
                    ))}

                    {(workout.bodyWeightBefore || workout.bodyWeightAfter) && (
                      <div style={{background: '#eff6ff', borderRadius: '8px', padding: '1rem'}}>
                        <p style={{fontWeight: 500, color: '#0f172a', marginBottom: '0.25rem'}}>–í–µ—Å —Ç–µ–ª–∞:</p>
                        <p style={{fontSize: '0.875rem', color: '#64748b'}}>
                          {workout.bodyWeightBefore && `–î–æ: ${workout.bodyWeightBefore.toFixed(1)} –∫–≥`}
                          {workout.bodyWeightBefore && workout.bodyWeightAfter && ' ‚Üí '}
                          {workout.bodyWeightAfter && `–ü–æ—Å–ª–µ: ${workout.bodyWeightAfter.toFixed(1)} –∫–≥`}
                        </p>
                      </div>
                    )}
                  </div>
                )}
              </div>
            );
          })}
        </div>
      );
    }

    function StatsTab({ workouts, exercises }) {
      const [selectedExerciseId, setSelectedExerciseId] = useState(null);

      const totalWorkouts = workouts.length;
      const totalSets = workouts.reduce((sum, w) => sum + w.exercises.reduce((s, e) => s + e.sets.length, 0), 0);
      const totalVolume = workouts.reduce(
        (sum, w) => sum + w.exercises.reduce((s, e) => s + e.sets.reduce((v, set) => v + set.weight * set.reps, 0), 0),
        0
      );
      const avgMood = workouts.filter(w => w.overallMood).length
        ? (workouts.filter(w => w.overallMood).reduce((sum, w) => sum + (w.overallMood || 0), 0) / workouts.filter(w => w.overallMood).length).toFixed(1)
        : 'N/A';
      
      const latestWeight = [...workouts].reverse().find(w => w.bodyWeightAfter)?.bodyWeightAfter || 
                           [...workouts].reverse().find(w => w.bodyWeightBefore)?.bodyWeightBefore;
      
      const totalMs = workouts.reduce((sum, w) => w.endDate ? sum + (new Date(w.endDate).getTime() - new Date(w.startDate).getTime()) : sum, 0);
      const totalHours = Math.round(totalMs / 3600000);

      const stats = [
        { label: '–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫', value: totalWorkouts, icon: 'üí™', gradient: 'linear-gradient(135deg, #3b82f6 0%, #4f46e5 100%)' },
        { label: '–ü–æ–¥—Ö–æ–¥–æ–≤', value: totalSets, icon: 'üìà', gradient: 'linear-gradient(135deg, #10b981 0%, #14b8a6 100%)' },
        { label: '–ü–æ–¥–Ω—è—Ç–æ —Ç–æ–Ω–Ω', value: (totalVolume / 1000).toFixed(1), icon: '‚öñÔ∏è', gradient: 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)' },
        { label: '–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ', value: avgMood, icon: '‚ù§Ô∏è', gradient: 'linear-gradient(135deg, #f59e0b 0%, #f97316 100%)' },
        { label: '–í–µ—Å (–∫–≥)', value: latestWeight ? latestWeight.toFixed(1) : 'N/A', icon: '‚öñÔ∏è', gradient: 'linear-gradient(135deg, #f43f5e 0%, #dc2626 100%)' },
        { label: '–ß–∞—Å–æ–≤ –≤ –∑–∞–ª–µ', value: totalHours, icon: '‚è±Ô∏è', gradient: 'linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)' },
      ];

      const exercisesWithData = exercises.filter(ex => 
        workouts.some(w => w.exercises.some(e => e.exerciseId === ex.id && e.sets.length > 0))
      );

      const getExerciseChartData = (exerciseId) => {
        const data = [];
        workouts.forEach(w => {
          const ex = w.exercises.find(e => e.exerciseId === exerciseId);
          if (ex && ex.sets.length > 0) {
            data.push({
              date: new Date(w.startDate).toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit' }),
              maxWeight: Math.max(...ex.sets.map(s => s.weight)),
              volume: ex.sets.reduce((a, s) => a + s.weight * s.reps, 0) / 1000
            });
          }
        });
        return data;
      };

      const getBodyWeightData = () => {
        return workouts
          .filter(w => w.bodyWeightBefore || w.bodyWeightAfter)
          .map(w => ({
            date: new Date(w.startDate).toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit' }),
            before: w.bodyWeightBefore,
            after: w.bodyWeightAfter
          }));
      };

      const getMoodData = () => {
        return workouts
          .filter(w => w.overallMood)
          .map(w => ({
            date: new Date(w.startDate).toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit' }),
            mood: w.overallMood
          }));
      };

      const selectedExerciseData = selectedExerciseId ? getExerciseChartData(selectedExerciseId) : [];
      const selectedExerciseName = exercises.find(e => e.id === selectedExerciseId)?.name;
      const bodyWeightData = getBodyWeightData();
      const moodData = getMoodData();

      return (
        <div>
          <div className="card">
            <h2 className="card-title" style={{marginBottom: '1.5rem'}}>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            
            <div className="grid" style={{marginBottom: '2rem'}}>
              {stats.map((stat, idx) => (
                <div key={idx} className="stat-card">
                  <div className="stat-icon" style={{background: stat.gradient}}>
                    {stat.icon}
                  </div>
                  <p className="stat-value">{stat.value}</p>
                  <p className="stat-label">{stat.label}</p>
                </div>
              ))}
            </div>

            {exercisesWithData.length > 0 && (
              <div className="form-group">
                <label className="label">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</label>
                <select
                  value={selectedExerciseId || ''}
                  onChange={(e) => setSelectedExerciseId(e.target.value ? Number(e.target.value) : null)}
                  className="input"
                >
                  <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ --</option>
                  {exercisesWithData.map(ex => (
                    <option key={ex.id} value={ex.id}>{ex.name}</option>
                  ))}
                </select>
              </div>
            )}

            {selectedExerciseId && selectedExerciseData.length > 0 && (
              <div className="chart-container">
                <h3 className="chart-title">{selectedExerciseName} ‚Äì –†–æ—Å—Ç —Ä–∞–±–æ—á–µ–≥–æ –≤–µ—Å–∞</h3>
                <LineChart data={selectedExerciseData} dataKey="maxWeight" color="#4f46e5" label="–∫–≥" />
              </div>
            )}

            {selectedExerciseId && selectedExerciseData.length > 0 && (
              <div className="chart-container">
                <h3 className="chart-title">{selectedExerciseName} ‚Äì –û–±—â–∏–π —Ç–æ–Ω–Ω–∞–∂</h3>
                <LineChart data={selectedExerciseData} dataKey="volume" color="#a855f7" label="—Ç" />
              </div>
            )}

            {bodyWeightData.length > 0 && (
              <div className="chart-container">
                <h3 className="chart-title">–î–∏–Ω–∞–º–∏–∫–∞ –≤–µ—Å–∞ —Ç–µ–ª–∞</h3>
                <DualLineChart data={bodyWeightData} />
              </div>
            )}

            {moodData.length > 0 && (
              <div className="chart-container">
                <h3 className="chart-title">–î–∏–Ω–∞–º–∏–∫–∞ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è</h3>
                <MoodChart data={moodData} />
              </div>
            )}
          </div>
        </div>
      );
    }

    function LineChart({ data, dataKey, color, label }) {
      if (data.length === 0) return null;

      const maxValue = Math.max(...data.map(p => p[dataKey]));
      const minValue = Math.min(...data.map(p => p[dataKey]));
      const range = maxValue - minValue || 1;

      const yAxisLabels = [];
      for (let i = 0; i <= 4; i++) {
        yAxisLabels.push((minValue + (range * i / 4)).toFixed(1));
      }

      return (
        <div style={{height: '300px', position: 'relative'}}>
          <svg viewBox="0 0 900 350" style={{width: '100%', height: '100%'}}>
            {yAxisLabels.map((labelValue, i) => (
              <g key={i}>
                <line
                  x1="60"
                  y1={280 - (i * 60)}
                  x2="850"
                  y2={280 - (i * 60)}
                  stroke="#e2e8f0"
                  strokeWidth="1"
                />
                <text
                  x="50"
                  y={285 - (i * 60)}
                  textAnchor="end"
                  style={{fontSize: '12px', fill: '#64748b', fontWeight: '500'}}
                >
                  {labelValue}
                </text>
              </g>
            ))}
            
            {data.length > 1 && (
              <>
                <polyline
                  points={data.map((point, idx) => {
                    const x = 100 + (idx / (data.length - 1)) * 750;
                    const y = 280 - ((point[dataKey] - minValue) / range) * 240;
                    return `${x},${y}`;
                  }).join(' ')}
                  fill="none"
                  stroke={color}
                  strokeWidth="3"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
                
                {data.map((point, idx) => {
                  const x = 100 + (idx / (data.length - 1)) * 750;
                  const y = 280 - ((point[dataKey] - minValue) / range) * 240;
                  return (
                    <g key={idx}>
                      <circle cx={x} cy={y} r="5" fill={color} />
                      <text
                        x={x}
                        y={y - 15}
                        textAnchor="middle"
                        style={{fontSize: '12px', fill: '#475569', fontWeight: '600'}}
                      >
                        {point[dataKey].toFixed(1)} {label}
                      </text>
                      <text
                        x={x}
                        y={320}
                        textAnchor="middle"
                        style={{fontSize: '11px', fill: '#64748b'}}
                      >
                        {point.date}
                      </text>
                    </g>
                  );
                })}
              </>
            )}
          </svg>
        </div>
      );
    }

    function DualLineChart({ data }) {
      if (data.length === 0) return null;

      const allWeights = data.flatMap(p => [p.before, p.after].filter(Boolean));
      const minWeight = Math.min(...allWeights);
      const maxWeight = Math.max(...allWeights);
      const range = maxWeight - minWeight || 1;

      const yAxisLabels = [];
      for (let i = 0; i <= 4; i++) {
        yAxisLabels.push((minWeight + (range * i / 4)).toFixed(1));
      }

      const beforeData = data.filter(p => p.before);
      const afterData = data.filter(p => p.after);

      return (
        <div style={{height: '300px', position: 'relative'}}>
          <svg viewBox="0 0 900 350" style={{width: '100%', height: '100%'}}>
            {yAxisLabels.map((labelValue, i) => (
              <g key={i}>
                <line
                  x1="60"
                  y1={280 - (i * 60)}
                  x2="850"
                  y2={280 - (i * 60)}
                  stroke="#e2e8f0"
                  strokeWidth="1"
                />
                <text
                  x="50"
                  y={285 - (i * 60)}
                  textAnchor="end"
                  style={{fontSize: '12px', fill: '#64748b', fontWeight: '500'}}
                >
                  {labelValue}
                </text>
              </g>
            ))}
            
            {beforeData.length > 1 && (
              <>
                <polyline
                  points={beforeData.map((point, idx) => {
                    const x = 100 + (data.indexOf(point) / (data.length - 1)) * 750;
                    const y = 280 - ((point.before - minWeight) / range) * 240;
                    return `${x},${y}`;
                  }).join(' ')}
                  fill="none"
                  stroke="#10b981"
                  strokeWidth="3"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
                {beforeData.map((point, idx) => {
                  const x = 100 + (data.indexOf(point) / (data.length - 1)) * 750;
                  const y = 280 - ((point.before - minWeight) / range) * 240;
                  return (
                    <g key={`before-${idx}`}>
                      <circle cx={x} cy={y} r="4" fill="#10b981" />
                      <text
                        x={x}
                        y={y + 20}
                        textAnchor="middle"
                        style={{fontSize: '11px', fill: '#047857', fontWeight: '600'}}
                      >
                        {point.before.toFixed(1)}
                      </text>
                    </g>
                  );
                })}
              </>
            )}
            
            {afterData.length > 1 && (
              <>
                <polyline
                  points={afterData.map((point, idx) => {
                    const x = 100 + (data.indexOf(point) / (data.length - 1)) * 750;
                    const y = 280 - ((point.after - minWeight) / range) * 240;
                    return `${x},${y}`;
                  }).join(' ')}
                  fill="none"
                  stroke="#f43f5e"
                  strokeWidth="3"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeDasharray="5,5"
                />
                {afterData.map((point, idx) => {
                  const x = 100 + (data.indexOf(point) / (data.length - 1)) * 750;
                  const y = 280 - ((point.after - minWeight) / range) * 240;
                  return (
                    <g key={`after-${idx}`}>
                      <circle cx={x} cy={y} r="4" fill="#f43f5e" />
                      <text
                        x={x}
                        y={y - 12}
                        textAnchor="middle"
                        style={{fontSize: '11px', fill: '#be123c', fontWeight: '600'}}
                      >
                        {point.after.toFixed(1)}
                      </text>
                    </g>
                  );
                })}
              </>
            )}

            {data.map((point, idx) => {
              const x = 100 + (idx / (data.length - 1)) * 750;
              return (
                <text
                  key={idx}
                  x={x}
                  y={320}
                  textAnchor="middle"
                  style={{fontSize: '11px', fill: '#64748b'}}
                >
                  {point.date}
                </text>
              );
            })}
          </svg>
          
          <div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '1.5rem', marginTop: '1rem', flexWrap: 'wrap'}}>
            <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
              <div style={{width: '16px', height: '16px', background: '#10b981', borderRadius: '50%'}}></div>
              <span style={{fontSize: '0.875rem', color: '#64748b'}}>–î–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</span>
            </div>
            <div style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
              <div style={{width: '16px', height: '16px', background: '#f43f5e', borderRadius: '50%'}}></div>
              <span style={{fontSize: '0.875rem', color: '#64748b'}}>–ü–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</span>
            </div>
          </div>
        </div>
      );
    }

    function MoodChart({ data }) {
      if (data.length === 0) return null;

      return (
        <div style={{height: '300px', position: 'relative'}}>
          <svg viewBox="0 0 900 350" style={{width: '100%', height: '100%'}}>
            {[1, 2, 3, 4, 5].map(i => (
              <g key={i}>
                <line
                  x1="60"
                  y1={280 - ((i - 1) / 4) * 240}
                  x2="850"
                  y2={280 - ((i - 1) / 4) * 240}
                  stroke="#e2e8f0"
                  strokeWidth="1"
                />
                <text
                  x="50"
                  y={285 - ((i - 1) / 4) * 240}
                  textAnchor="end"
                  style={{fontSize: '12px', fill: '#64748b', fontWeight: '500'}}
                >
                  {i}
                </text>
              </g>
            ))}
            
            {data.length > 1 && (
              <>
                <defs>
                  <linearGradient id="moodGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style={{stopColor: '#f59e0b'}} />
                    <stop offset="100%" style={{stopColor: '#10b981'}} />
                  </linearGradient>
                </defs>
                <polyline
                  points={data.map((point, idx) => {
                    const x = 100 + (idx / (data.length - 1)) * 750;
                    const y = 280 - ((point.mood - 1) / 4) * 240;
                    return `${x},${y}`;
                  }).join(' ')}
                  fill="none"
                  stroke="url(#moodGradient)"
                  strokeWidth="3"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
                
                {data.map((point, idx) => {
                  const x = 100 + (idx / (data.length - 1)) * 750;
                  const y = 280 - ((point.mood - 1) / 4) * 240;
                  const getMoodColor = (mood) => {
                    if (mood === 5) return '#10b981';
                    if (mood >= 4) return '#84cc16';
                    if (mood >= 3) return '#facc15';
                    if (mood >= 2) return '#fb923c';
                    return '#ef4444';
                  };
                  return (
                    <g key={idx}>
                      <circle cx={x} cy={y} r="5" fill={getMoodColor(point.mood)} />
                      <text
                        x={x}
                        y={y - 15}
                        textAnchor="middle"
                        style={{fontSize: '18px'}}
                      >
                        {point.mood === 1 ? 'üò´' : point.mood === 5 ? 'üòÑ' : 'üòê'}
                      </text>
                      <text
                        x={x}
                        y={320}
                        textAnchor="middle"
                        style={{fontSize: '11px', fill: '#64748b'}}
                      >
                        {point.date}
                      </text>
                    </g>
                  );
                })}
              </>
            )}
          </svg>
        </div>
      );
    }

    function AchievementsTab({ unlockedAchievements }) {
      return (
        <div className="card">
          <h2 className="card-title" style={{marginBottom: '1.5rem'}}>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
          
          {ACHIEVEMENT_CATEGORIES.map((category, catIdx) => (
            <div key={catIdx} style={{marginBottom: '2rem'}}>
              <h3 style={{fontSize: '1.125rem', fontWeight: 600, color: '#2563eb', marginBottom: '1rem', paddingBottom: '0.5rem', borderBottom: '2px solid #e2e8f0'}}>
                {category.name}
              </h3>
              <div className="achievement-grid">
                {category.achievements.map(achievement => {
                  const unlocked = unlockedAchievements.includes(achievement.id);
                  return (
                    <div
                      key={achievement.id}
                      className={`achievement-card ${unlocked ? 'unlocked' : 'locked'}`}
                    >
                      <div className={`achievement-icon ${unlocked ? '' : 'locked'}`}>
                        {achievement.icon}
                      </div>
                      <h4 className="achievement-title">{achievement.title}</h4>
                      <p className="achievement-desc">{achievement.description}</p>
                    </div>
                  );
                })}
              </div>
            </div>
          ))}
        </div>
      );
    }

    function SettingsTab({ exercises, onAddExercise, onDeleteExercise, onExportData, onResetData }) {
      const [newExerciseName, setNewExerciseName] = useState('');
      const [showLibraryModal, setShowLibraryModal] = useState(false);

      const addExercise = () => {
        const name = newExerciseName.trim();
        if (!name) {
          alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è');
          return;
        }
        if (exercises.some(e => e.name.toLowerCase() === name.toLowerCase())) {
          alert('–¢–∞–∫–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
          return;
        }
        onAddExercise(name);
        setNewExerciseName('');
        alert(`–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ¬´${name}¬ª –¥–æ–±–∞–≤–ª–µ–Ω–æ!`);
      };

      const userExercises = exercises.filter(e => !e.system);

      return (
        <div>
          <div className="card">
            <h2 className="card-title" style={{marginBottom: '1.5rem'}}>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

            <div style={{display: 'flex', flexDirection: 'column', gap: '2rem'}}>
              <div>
                <h3 style={{fontSize: '1.125rem', fontWeight: 600, color: '#0f172a', marginBottom: '1rem'}}>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</h3>
                <div style={{display: 'flex', gap: '0.75rem', marginBottom: '1rem', flexWrap: 'wrap'}}>
                  <input
                    type="text"
                    value={newExerciseName}
                    onChange={e => setNewExerciseName(e.target.value)}
                    placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è"
                    onKeyDown={e => e.key === 'Enter' && addExercise()}
                    className="input"
                    style={{flex: 1, minWidth: '200px'}}
                  />
                  <button onClick={addExercise} className="btn btn-primary">
                    –î–æ–±–∞–≤–∏—Ç—å
                  </button>
                </div>

                <button onClick={() => setShowLibraryModal(true)} className="btn btn-secondary" style={{marginBottom: '1rem', fontSize: '0.875rem'}}>
                  <span>üëÅÔ∏è</span> –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
                </button>

                {userExercises.length > 0 && (
                  <div style={{display: 'flex', flexDirection: 'column', gap: '0.5rem'}}>
                    <h4 style={{fontSize: '0.875rem', fontWeight: 600, color: '#475569', textTransform: 'uppercase', marginBottom: '0.5rem'}}>–í–∞—à–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h4>
                    {userExercises.map(ex => (
                      <div key={ex.id} style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '0.75rem', background: '#f8fafc', borderRadius: '8px'}}>
                        <div>
                          <p style={{fontWeight: 500, color: '#0f172a'}}>{ex.name}</p>
                          <p style={{fontSize: '0.75rem', color: '#64748b'}}>{ex.group}</p>
                        </div>
                        <button onClick={() => onDeleteExercise(ex.id)} style={{background: 'none', border: 'none', color: '#ef4444', cursor: 'pointer', fontSize: '1.25rem'}}>
                          üóëÔ∏è
                        </button>
                      </div>
                    ))}
                  </div>
                )}
              </div>

              <div>
                <h3 style={{fontSize: '1.125rem', fontWeight: 600, color: '#0f172a', marginBottom: '1rem'}}>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
                <div style={{display: 'flex', flexDirection: 'column', gap: '0.75rem'}}>
                  <button onClick={onExportData} className="btn btn-secondary" style={{justifyContent: 'center'}}>
                    <span>üíæ</span> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                  </button>
                  <button onClick={onResetData} className="btn btn-danger" style={{justifyContent: 'center'}}>
                    <span>üóëÔ∏è</span> –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                  </button>
                </div>
              </div>
            </div>
          </div>

          {showLibraryModal && (
            <Modal onClose={() => setShowLibraryModal(false)} title="–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π">
              <div style={{display: 'flex', flexDirection: 'column', gap: '1.5rem', maxHeight: '60vh', overflowY: 'auto'}}>
                {Object.entries(exerciseDatabase).map(([group, exList]) => (
                  <div key={group}>
                    <h4 style={{fontWeight: 600, color: '#475569', marginBottom: '0.75rem', textTransform: 'uppercase', fontSize: '0.875rem'}}>{group}</h4>
                    <div style={{display: 'flex', flexDirection: 'column', gap: '0.5rem'}}>
                      {exList.map(exName => {
                        const exercise = exercises.find(e => e.name === exName);
                        return exercise ? (
                          <div key={exercise.id} style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '0.75rem', background: '#f8fafc', borderRadius: '8px'}}>
                            <span style={{color: '#475569'}}>{exercise.name}</span>
                            {!exercise.system && (
                              <button onClick={() => { onDeleteExercise(exercise.id); if (!exercises.find(e => e.id === exercise.id && !e.system)) { setShowLibraryModal(false); } }} style={{background: 'none', border: 'none', color: '#ef4444', cursor: 'pointer', fontSize: '1.125rem'}}>
                                üóëÔ∏è
                              </button>
                            )}
                          </div>
                        ) : null;
                      })}
                    </div>
                  </div>
                ))}
                {userExercises.length > 0 && (
                  <div>
                    <h4 style={{fontWeight: 600, color: '#475569', marginBottom: '0.75rem', textTransform: 'uppercase', fontSize: '0.875rem'}}>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ</h4>
                    <div style={{display: 'flex', flexDirection: 'column', gap: '0.5rem'}}>
                      {userExercises.map(ex => (
                        <div key={ex.id} style={{display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '0.75rem', background: '#f8fafc', borderRadius: '8px'}}>
                          <span style={{color: '#475569'}}>{ex.name}</span>
                          <button onClick={() => onDeleteExercise(ex.id)} style={{background: 'none', border: 'none', color: '#ef4444', cursor: 'pointer', fontSize: '1.125rem'}}>
                            üóëÔ∏è
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </Modal>
          )}
        </div>
      );
    }

    function Modal({ onClose, title, children }) {
      return (
        <div className="modal-overlay" onClick={onClose}>
          <div className="modal" onClick={e => e.stopPropagation()}>
            <div className="modal-header">
              <h3 className="modal-title">{title}</h3>
              <button onClick={onClose} className="modal-close">‚úñÔ∏è</button>
            </div>
            <div className="modal-body">{children}</div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
